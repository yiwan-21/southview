<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Messages</title>
    <link rel="icon" href="/images/Logo SV.png">
    <link rel="stylesheet" href="message.css">
    <link rel="stylesheet" href="/scrollbar.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400;500;600;700;800;900&display=swap"
        rel="stylesheet">
</head>

<body>
    <div class="navbar"></div>

    <div class="main-wrapper">
        <div class="user-list scroll-bar-left-wrapper">
            <div class="scroll-bar-left"></div>
        </div>

        <div class="message scroll-bar-wrapper">
            <div class="scroll-bar"></div>
        </div>
    </div>

    <script>
        const userList = document.querySelector('.user-list').firstElementChild;
        const message = document.querySelector('.message').firstElementChild;

        const users = [
            {
                name: 'Jacob Jones',
                avatar: 'https://images.unsplash.com/photo-1558624232-75ee22af7e67?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxzZWFyY2h8NHx8Y2hhcmFjdGVyfGVufDB8MnwwfHw%3D&auto=format&fit=crop&w=500&q=60',
                message: 'Lorem ipsum dolor sit amet consectetur adipisicing elit. Deleniti!',
                time: '04/24/2022 18:56:07 GMT+0800',
                new: true,
            },
            {
                name: 'Leslie Alexander',
                avatar: 'https://images.unsplash.com/photo-1593085512500-5d55148d6f0d?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxzZWFyY2h8MXx8Y2hhcmFjdGVyfGVufDB8MnwwfHw%3D&auto=format&fit=crop&w=500&q=60',
                message: 'Lorem ipsum dolor sit amet consectetur adipisicing elit. Optio obcaecati qui nostrum?',
                time: '04/23/2022 13:24:47 GMT+0800',
                new: false,
            },
            {
                name: 'Eleanor Pena',
                avatar: 'https://images.unsplash.com/photo-1586374579358-9d19d632b6df?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxzZWFyY2h8MTF8fGljb258ZW58MHx8MHx8&auto=format&fit=crop&w=500&q=60',
                message: 'Lorem ipsum dolor sit amet.',
                time: '04/22/2022 12:56:07 GMT+0800',
                new: false,
            },
            {
                name: 'Kathryn Murphy',
                avatar: 'https://images.unsplash.com/photo-1453738773917-9c3eff1db985?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxzZWFyY2h8ODh8fGljb258ZW58MHx8MHx8&auto=format&fit=crop&w=500&q=60',
                message: 'Lorem ipsum dolor sit amet consectetur.',
                time: '04/24/2022 09:30:00 GMT+0800',
                new: true,
            },
            {
                name: 'Wade Warren',
                avatar: 'https://images.unsplash.com/photo-1576490467522-680bc4892baf?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxzZWFyY2h8MjB8fGNhcnRvb258ZW58MHwyfDB8fA%3D%3D&auto=format&fit=crop&w=500&q=60',
                message: 'Lorem ipsum dolor sit amet consectetur adipisicing elit. Optio obcaecati qui nostrum?',
                time: '04/23/2022 13:24:47 GMT+0800',
                new: false,
            },
            {
                name: 'Marvin McKinney',
                avatar: 'https://images.unsplash.com/photo-1541534401786-2077eed87a74?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxzZWFyY2h8NHx8cHJvZmlsZSUyMHBpY3R1cmV8ZW58MHwyfDB8fA%3D%3D&auto=format&fit=crop&w=500&q=60',
                message: 'Lorem ipsum dolor sit amet consectetur adipisicing elit. Deleniti!',
                time: '04/24/2022 18:56:07 GMT+0800',
                new: true,
            },
        ];

        users.forEach(user => {
            const newUser = createUser(user);
            newUser.addEventListener('click', () => {
                userList.querySelectorAll('.user').forEach(user => user.classList.remove('user-active'));
                newUser.classList.add('user-active');
                const notification = newUser.querySelector('.notification-active');
                if (notification) {
                    notification.classList.remove('notification-active');
                    notification.classList.add('notification');
                }
                user.new = false;
                message.innerHTML = '';
                message.appendChild(createMessagePage(user));
                const textarea = message.querySelector('.textarea');
                textarea?.lastElementChild.scrollIntoView();
            });
            userList.appendChild(newUser);
        })

        function createUser(user) {
            const userElement = document.createElement('div');
            userElement.classList.add('user');
            userElement.innerHTML = `
                <div class="user-info">
                    <span class=${user.new ? 'notification-active' : 'notification'}>
                        &#9679;
                    </span>
                    <img src="${user.avatar}" alt="avatar">
                    <div class="text">
                        <span class="name">${user.name}</span>
                        <span class="time">${new Date(user.time).toLocaleDateString()}</span>
                        <div>
                            ${user.message}
                        </div>
                    </div>
                </div>
            `;
            return userElement;
        }

        function createMessagePage(user) {
            const messagePage = document.createElement('div');
            messagePage.innerHTML = `
            <fieldset class="date">
                    <legend>
                        24/4/2022
                    </legend>
                </fieldset>

                <div class="textarea">
                    <div class="opposite">
                        <img src=${user.avatar} alt="avatar">
                        <div class="opposite-text">
                            Lorem, ipsum dolor sit amet consectetur adipisicing elit. Asperiores provident fuga quos.
                        </div>
                    </div>
                    <div class="self">
                        Lorem ipsum dolor sit amet consectetur, adipisicing elit. Perferendis debitis quaerat, cum eum
                        quam possimus omnis quae culpa voluptates iusto?
                    </div>
                    <div class="opposite">
                        <img src=${user.avatar} alt="avatar">
                        <div class="opposite-text">
                            Lorem ipsum dolor sit amet.
                        </div>
                    </div>
                    <div class="self">
                        Lorem, ipsum.
                    </div>
                    <div class="opposite">
                        <img src=${user.avatar} alt="avatar">
                        <div class="opposite-text">
                            Lorem ipsum dolor sit amet consectetur, adipisicing elit. Voluptas vitae ad deserunt eveniet
                            accusamus facere laboriosam quaerat omnis, vero nulla?
                        </div>
                    </div>
                </div>

                <form class="reply" onsubmit="sendMessage(event)">
                    <input type="text" placeholder="Write a message...">
                    <button type="submit">
                        <svg width="24" height="25" viewBox="0 0 24 25" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M21.944 2.36621L11.0137 13.2966" stroke="#001329" stroke-linecap="round"
                                stroke-linejoin="round" />
                            <path d="M21.9437 2.36621L14.988 22.2396L11.0133 13.2965L2.07031 9.32188L21.9437 2.36621Z"
                                stroke="#001329" stroke-linecap="round" stroke-linejoin="round" />
                        </svg>
                    </button>
                </form>
            `;
            return messagePage;
        }

        function sendMessage(event) {
            event.preventDefault();
            const textarea = document.querySelector('.textarea');
            textarea?.lastElementChild.scrollIntoView();
            const input = event.target.firstElementChild;
            const message = input.value;
            input.value = '';
            const newNode = document.createElement('div');
            newNode.classList.add('self');
            newNode.textContent = message;
            textarea.appendChild(newNode);
            newNode.scrollIntoView();
        }

    </script>
</body>

</html>